
Sure, here's an updated version of the code snippet that includes the necessary checks and exceptions:

```

------------------------------------------------------
