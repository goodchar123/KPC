
I apologize for the confusion in my previous responses. Here's the updated code that includes all the checks you
------------------------------------------------------
